
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <title>üèä Nibi-Swap ¬∑ Nibiru Chain Documentation</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="Real world examples of content published using HonKit.">
        <meta name="generator" content="HonKit 3.7.1">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
        <link rel="stylesheet" href="../styles/website.css">
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="../perps/README.md" />
    
    
    <link rel="prev" href="perps.html" />
    

    </head>
    <body>
        
<div class="book honkit-cloak">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        <li class="header">Overview</li>
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    ‚ú® About Nibiru
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../GLOSSARY.html">
            
                <a href="../GLOSSARY.html">
            
                    
                    üìò Glossary
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Nibiru Protocol</li>
        
        
    
        <li class="chapter " data-level="2.1" data-path="perps.html">
            
                <a href="perps.html">
            
                    
                    ‚Äçü§ù Nibi-Perps
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="2.2" data-path="amm.html">
            
                <a href="amm.html">
            
                    
                    üèä Nibi-Swap
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="../perps/README.md">
            
                <span>
            
                    
                    üîÆ Price Feed Oracles
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.4" data-path="../stablecoin/">
            
                <a href="../stablecoin/">
            
                    
                    üíµ NUSD Stablecoin
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Developer Docs</li>
        
        
    
        <li class="chapter " data-level="3.1" data-path="../pages.html">
            
                <a href="../pages.html">
            
                    
                    üß† Module Specifications
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2" data-path="../pages.html">
            
                <a href="../pages.html">
            
                    
                    ‚õìÔ∏èÔ∏è Testnet and the nibid CLI
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.3" data-path="../structure.html">
            
                <a href="../structure.html">
            
                    
                    ‚öõÔ∏èÔ∏è Validators
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Learn More</li>
        
        
    
        <li class="chapter " data-level="4.1" data-path="../faq.md">
            
                <span>
            
                    
                    ‚ùì FAQs
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2" data-path="../tokenomics.html">
            
                <a href="../tokenomics.html">
            
                    
                    üíπ Tokenomics
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://github.com/honkit/honkit" target="blank" class="gitbook-link">
            Published with HonKit
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >üèä Nibi-Swap</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                

                                <h1 id="spot-amm-nibi-swap">Spot AMM: Nibi-Swap</h1>
<p>Separate from Nibiru‚Äôs perps product, Nibiru includes a constant-product spot AMM called Nibi-Swap. Pools on Nibi-Swap can include more than two assets with differing token weights. Denoting $\mathcal{W}_n$ as the normalized weight and $\mathcal{Q}_n$ as the quantity of asset $n$, each pool has an <strong>invariant $k$</strong> defined by:  </p>
<p>$$ \prod\limits_{n=1}^t \mathcal{Q}_n^{\mathcal{W}_n} = k. $$</p>
<p>For a given pool, the sum of the normalized weights must equal 1. The invariant $k$ does not change when users swap assets. It only changes when a liquidity provider adds or removes liquidity. Each pool contains $t$ tokens. Thus, the number of trading pairs (combinations of size 2) is </p>
<p>$$
\binom{t}{2} = \frac{t!}{2!(t - 2)!} .</p>
<p>$$</p>
<p>A spot price exists between each pair of tokens. The spot price is the ratio between the two normalized quantities:  </p>
<p>Formally, the instantaneous spot price that the swap executes at is computed as the ratio of the token balances normalized by the token weight:</p>
<p>$$
\text{SpotPrice}<em>{\text{in$\to$ out}} = \frac{(\mathcal{Q}</em>{in}/\mathcal{W}<em>{in})}{(\mathcal{Q}</em>{out}/\mathcal{W}_{out})}
\
\
\mathcal{B}_i = \text{amount of token in}
\
\mathcal{W}_i = \text{weight of token in}
\
\mathcal{B}_o = \text{amount of token out}
\
\mathcal{W}_i = \text{weight of token out}</p>
<p>$$</p>
<p>If liquidity providers don‚Äôt modify the asset reserves, then k remains constant and the price changes solely based on trades since the asset weights also remain constant. This ensures that the price of the asset bought increases while the price of the asset sold decreases. The arbitrage opportunities guarantee that the prices offered by the pools move in conjunction with the rest of the market.</p>

                                
<hr>
<div class="btn-group btn-group-justified">
    
    <a class="btn" href="perps.html"><b>Previous:</b> ‚Äçü§ù Nibi-Perps</a>
    
    
    <a class="btn" href="../perps/README.md"><b>Next:</b> üîÆ Price Feed Oracles</a>
    
</div>

                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="perps.html" class="navigation navigation-prev " aria-label="Previous page: ‚Äçü§ù Nibi-Perps">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="../perps/README.md" class="navigation navigation-next " aria-label="Next page: üîÆ Price Feed Oracles">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"description":"Real world examples of content published using HonKit.","title":"üèä Nibi-Swap","level":"2.2","depth":1,"next":{"title":"üîÆ Price Feed Oracles","level":"2.3","depth":1,"path":"perps/README.md","ref":"perps/README.md","articles":[]},"previous":{"title":"‚Äçü§ù Nibi-Perps","level":"2.1","depth":1,"path":"content/perps.md","ref":"content/perps.md","articles":[]},"dir":"ltr"},"config":{"plugins":[],"root":"./nibiru-book","styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56},"embedFonts":false},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{"version":"3.7.1"},"title":"Nibiru Chain Documentation","gitbook":"3.1.1"},"file":{"path":"content/amm.md","mtime":"2022-07-18T20:28:23.064Z","type":"markdown"},"gitbook":{"version":"3.7.1","time":"2022-07-19T03:55:42.726Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <noscript>
        <style>
            .honkit-cloak {
                display: block !important;
            }
        </style>
    </noscript>
    <script>
        // Restore sidebar state as critical path for prevent layout shift
        function __init__getSidebarState(defaultValue){
            var baseKey = "";
            var key = baseKey + ":sidebar";
            try {
                var value = localStorage[key];
                if (value === undefined) {
                    return defaultValue;
                }
                var parsed = JSON.parse(value);
                return parsed == null ? defaultValue : parsed;
            } catch (e) {
                return defaultValue;
            }
        }
        function __init__restoreLastSidebarState() {
            var isMobile = window.matchMedia("(max-width: 600px)").matches;
            if (isMobile) {
                // Init last state if not mobile
                return;
            }
            var sidebarState = __init__getSidebarState(true);
            var book = document.querySelector(".book");
            // Show sidebar if it enabled
            if (sidebarState && book) {
                book.classList.add("without-animation", "with-summary");
            }
        }

        try {
            __init__restoreLastSidebarState();
        } finally {
            var book = document.querySelector(".book");
            book.classList.remove("honkit-cloak");
        }
    </script>
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

